<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>24. Quadratic Optimization Models &#8212; OptimizationModels 1.02 April 4, 2024 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=712fa57f" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css?v=edc3226b" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=8bd57eb4" />
    <script src="_static/documentation_options.js?v=d77a62b4"></script>
    <script src="_static/doctools.js?v=fd6eb6e6"></script>
    <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script>window.MathJax = "{'tex': { 'macros': {RR: '{\\bf R}', R: '{\\mathbb{R}}', bold: ['{\\bf #1}', 1] }, 'environments': {braced: ['\\left\\{', '\\right\\}'] }, 'inlineMath': [['$', '$'], ['\\(', '\\)']] } }"</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="25. Appendix" href="Appendix.html" />
    <link rel="prev" title="23. Arc routing" href="Arcrouting.html" />
<link rel="stylesheet" type="text/css" 
     href="_static/custom.css" /> 


  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="Arcrouting.html" title="Previous document"><span class="section-number">23. </span>Arc routing</a>
        </li>
        <li>
          <a href="Appendix.html" title="Next document"><span class="section-number">25. </span>Appendix</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <p class="hidden"><span class="math notranslate nohighlight">\(\newcommand{\R}{{\mathbb{R}}}\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\Z}{{\mathbb{Z}}}\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\N}{{\mathbb{N}}}\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\var}[1]{{\color{red}{\mathbf{#1}}}}\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\param}[1]{{\color{blue}{#1}}}\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\mathsc}[1]{{\normalfont\textsc{#1}}}\)</span>
<span class="math notranslate nohighlight">\(\def\sc#1{\dosc#1\csod}\)</span>
<span class="math notranslate nohighlight">\(\def\dosc#1#2\csod{{\rm{#1{\rm\small #2}}}}\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\set}[1]{{\sc#1}}\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\mathvar}[1]{\var{#1}}\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\mathpar}[1]{\param{#1}}\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\half}{{\small{\frac{1}{2}}}}\)</span></p>
<section id="quadratic-optimization-models">
<h1><span class="section-number">24. </span>Quadratic Optimization Models<a class="headerlink" href="#quadratic-optimization-models" title="Link to this heading">¶</a></h1>
<p>The step from linear models to quadratic ones can be a giant
one. This is  not due to the fact that we are abandoning the linear world and enter
the non linear one. Or, at least, it depends. The really difficult
border to cross is not the one of non linearity, but another one: the
border between convex and non convex optimization problems. We do not
wish to go into details here on this theoretical and algorithmic
aspect.
Convex optimization (see some definitions in the <a class="reference internal" href="Appendix.html#appendix"><span class="std std-ref">Appendix</span></a>)  is often (although
not always) computationally tractable, in the sense that there exist
polynomial complexity algorithms for a very large set of convex
problems. Almost always, on the contrary, if either the objective
function or the feasible set is non convex, the optimization problem
becomes intractable (e.g., we do not know any algorithm whose
complexity is better than exponential), or even unsolvable (in the
sense that there cannot exist any finite procedure guaranteed to find
a global optimum, or even an approximation of it).</p>
<p>Sorry for the imprecision of the above concepts! But we do not wish to
enter this very deep subject in a book on modeling. What makes convex
optimization so special is the fact that these problems enjoy several
very important properties which are not enjoyed by most of the other
problems. First, any feasible solution which is a <span class="target" id="index-0"></span>local
optimum is also a <span class="target" id="index-1"></span>global optimum (refer to any
textbook on analysis or optimization for precise
definitions). Moreover there exist many optimality conditions which,
in general, are just necessary and which, in convex problems, become
sufficient.</p>
<p>As a simple example: linear optimization is an example of a convex
optimization problem. And, in fact, there exist excellent algorithms
to solve even large scale problems. By the way: the simplex algorithm,
which we invariably used in this volume and which is the top used
method for this class of problems, has an exponential worst case
complexity! But the reader should not worry too much: this method is
excellent in practice - the theoretical worst cases which proof the
exponential complexity of the simplex method simply do not appear in real life
situations. And, as a simple example of a problem which is <em>not</em> a
convex one, linear <em>integer</em> optimization is one we encountered in
this book. And we know it is a difficult one. In this case, non
convexity is in the feasible set: being discrete, it cannot be convex,
unless it is empty or it reduces to a singleton.</p>
<p>In this part we will only give a tiny set of examples, without any
desire even to approximately describe the possibilities opened by the
apparently small change in the model, in which the objective function,
instead of being a polynomial of degree one, becomes a polynomial of
degree 2. We will thus give a tiny set of practical cases in which we
might be interested in solving a problem of the form</p>
<div class="math notranslate nohighlight">
\begin{align*}
   \min \half  \var{x}^T \param{Q} \var x &amp; \\
   \param{A} \var{x} &amp; = \param{b} \\
   \var{x} &amp; \geq 0
\end{align*}</div><p>where <span class="math notranslate nohighlight">\(Q \in \R^{n \times n}\)</span> is a symmetric matrix. The above
problem might be generalized to include also quadratic constraints or
integer variables. We would like to point out, again, that the
simplicity of this formulation should not be confused with its
complexity. As a simple matter of thought, consider the fact that any
linear optimization problem in binary  variables can be equivalently
written as a quadratically constrained problem:</p>
<div class="math notranslate nohighlight">
\begin{align*}
   \min \param{c}^T \var x &amp; \\
   \param{A} \var{x} &amp; = \param{b} \\
   \var{x} &amp; \geq 0
   \\
   \var{x} &amp; \leq 1 \\
   \var{x}_j (1-\var{x}_j) &amp; = 0 &amp; \forall\,j
\end{align*}</div><p>or, choosing a large enough penalty parameter <span class="math notranslate nohighlight">\(\lambda\)</span>, as
the quadratic optimization problem</p>
<div class="math notranslate nohighlight">
\begin{align*}
   \min \param{c}^T \var x +  \lambda \var{x}^T(1-\var{x}) &amp; \\
   \param{A} \var{x} &amp; = \param{b} \\
   \var{x} &amp; \geq 0
   \\
   \var{x} &amp; \leq 1
\end{align*}</div><p>and this should be enough to convince the reader of the possibly
high complexity of quadratic optimization.</p>
<p>Of course <em>some</em> sub-classes of quadratic optimization models are
indeed easy to solve and lend themselves to solution strategies which
are not very dissimilar, in their basic ideas,  implementation and
computational complexity, from those of linear optimization. The
widest class of “easy” quadratic optimization problems is that
characterized by a convex objective function. This is the case when
matrix <span class="math notranslate nohighlight">\(Q\)</span> is <span class="target" id="index-2"></span>positive-semidefinite, which means that</p>
<div class="math notranslate nohighlight">
\begin{align*}
   v^T Q v &amp; \geq 0 &amp; \forall \, v \in \R^n
\end{align*}</div><p>or, equivalently, when all the <span class="target" id="index-3"></span>eigenvalues of the matrix,
besides being real (as a consequence of symmetry) are also <em>non
negative</em>. Even better is the case in which the matrix is
<span class="target" id="index-4"></span>positive definite:</p>
<div class="math notranslate nohighlight">
\begin{align*}
   v^T Q v &amp; &gt; 0 &amp; \forall \, v\ne 0
\end{align*}</div><p>or when its eigenvalues are all strictly positive. Our first examples
fall within this framework.</p>
<section id="solving-linear-electrical-networks">
<h2><span class="section-number">24.1. </span>Solving linear electrical networks<a class="headerlink" href="#solving-linear-electrical-networks" title="Link to this heading">¶</a></h2>
<p>We cannot  go  much into details on the theory and practice
of electrical circuits. We refer the readers to the vast literature on
the subject; the literature is rich not only of first principles, but
also of computational methods oriented towards a solution “by hand” of
small networks. Here we take a different approach, which is very well
introduced in the classical <span id="id1">[<a class="reference internal" href="Bibliography.html#id11" title="Jack B. Dennis. Mathematical programming and electrical networks. Thesis, Massachusetts Institute of Technology, 1959. URL: https://dspace.mit.edu/handle/1721.1/13366.">Dennis, 1959</a>]</span>. Assume we are given a
graph, composed of nodes and arcs. Every arc is associated with a
<em>linear</em> electric component.</p>
<div class="figure" style="text-align: center"><p><img  src="_images/tikz-45460a35011447bcf598874ae8f683cb09bb12a5.png" alt="Figure made with TikZ" /></p>
</div><p>In  the example we have a tiny electrical network with two types of
components: voltage generators, which keep a fixed difference of
potential at their extremes, and resistors, which are characterized by
a fixed flow of current, linked to a voltage drop by Ohm’s law. We
might easily add other linear components, like diodes or inductances,
but we wish to keep the example as simple as possible. The above
network can be represented as a graph whose arcs are of different
types, depending on the component associated to them. The following
data file represents the circuit above:</p>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">circuit.dat</span><a class="headerlink" href="#id7" title="Link to this code">¶</a></div>
<div class="highlight-ampl notranslate"><div class="highlight"><pre><span></span><span class="kd">set</span><span class="w"> </span><span class="nv">NODES</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span>A<span class="w"> </span>B<span class="w"> </span>C<span class="w"> </span>D<span class="w"> </span>E<span class="w"> </span>F<span class="p">;</span>

<span class="kd">set</span><span class="w"> </span><span class="nv">RESISTORS</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span>
<span class="p">(</span>A<span class="p">,</span><span class="w"> </span>B<span class="p">)</span><span class="w"> </span>
<span class="p">(</span>B<span class="p">,</span><span class="w"> </span>E<span class="p">)</span><span class="w"> </span>
<span class="p">(</span>C<span class="p">,</span><span class="w"> </span>B<span class="p">)</span>
<span class="p">(</span>D<span class="p">,</span><span class="w"> </span>F<span class="p">)</span>
<span class="p">;</span>
<span class="kd">set</span><span class="w"> </span><span class="nv">GENERATORS</span><span class="w"> </span><span class="p">:</span><span class="o">=</span>
<span class="p">(</span>F<span class="p">,</span>A<span class="p">)</span><span class="w"> </span><span class="p">(</span>D<span class="p">,</span>E<span class="p">)</span><span class="w"> </span><span class="p">(</span>E<span class="p">,</span>C<span class="p">);</span>

<span class="kd">param</span><span class="w"> </span><span class="nv">R</span><span class="w"> </span><span class="p">:</span><span class="o">=</span>
A<span class="w"> </span>B<span class="w"> </span><span class="mi">1</span>
B<span class="w"> </span>E<span class="w"> </span><span class="mi">2</span>
C<span class="w"> </span>B<span class="w"> </span><span class="mi">3</span>
D<span class="w"> </span>F<span class="w"> </span><span class="mf">1.5</span>
<span class="p">;</span>

<span class="kd">param</span><span class="w"> </span><span class="nv">V</span><span class="p">:</span><span class="o">=</span>
F<span class="w"> </span>A<span class="w"> </span><span class="mi">18</span>
D<span class="w"> </span>E<span class="w"> </span><span class="mi">3</span>
E<span class="w"> </span>C<span class="w"> </span><span class="mi">19</span>
<span class="p">;</span>

<span class="kd">param</span><span class="w"> </span><span class="nv">Ground</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span>E<span class="p">;</span>
</pre></div>
</div>
</div>
<p>In order to find voltages and currents in equilibrium conditions, an
energy minimization problem can be solved. In fact the flow of current at
steady state is such as to minimize the total energy. In circuits like
the one above, it can be shown that, from Ohm’s law, the energy of the
circuit can be expressed as a linear combination of the squares of the
voltages across resistors, with coefficients equal to the
<span class="target" id="index-5"></span>conductance of each resistor, which corresponds to the
inverse of the <span class="target" id="index-6"></span>resistance.  Voltages in the circuit are
easily computed, depending on the electric element associated to each
arc. In general, denoting by <span class="math notranslate nohighlight">\(\var{v}_{ij}\)</span> the tension
(voltage) along an arc <span class="math notranslate nohighlight">\((i,j)\)</span> and by <span class="math notranslate nohighlight">\(\var{u}_i\)</span> the
potential of a node, the relevant equations are:</p>
<div class="math notranslate nohighlight">
\begin{align*}
\var{u}_j - \var{u}_i &amp; = \param{V}_{ij}
\end{align*}</div><p>for an arc containing a voltage generator, and</p>
<div class="math notranslate nohighlight">
\begin{align*}
\var{u}_j - \var{u}_i &amp; = \var{v}_{ij}
\end{align*}</div><p>for an arc associated to a resistor. The energy is obtained  as</p>
<div class="math notranslate nohighlight">
\begin{align*}
\sum_{(i,j) \in \set{Resistors}}  \frac{\var{v}^2_{ij}}{\param{R}_{ij}}
\end{align*}</div><p>where <span class="math notranslate nohighlight">\(\param{R}_{ij}\)</span> is the resistance on arc
<span class="math notranslate nohighlight">\((i,j)\)</span>.
The model below implements this energy optimization problem:</p>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">circuit.mod</span><a class="headerlink" href="#id8" title="Link to this code">¶</a></div>
<div class="highlight-ampl notranslate"><div class="highlight"><pre><span></span><span class="kd">set</span><span class="w"> </span><span class="nv">NODES</span><span class="p">;</span>

<span class="kd">set</span><span class="w"> </span><span class="nv">RESISTORS</span><span class="w"> </span><span class="kr">within</span><span class="w"> </span>NODES<span class="w"> </span><span class="kr">cross</span><span class="w"> </span>NODES<span class="p">;</span>
<span class="kd">set</span><span class="w"> </span><span class="nv">GENERATORS</span><span class="w"> </span><span class="kr">within</span><span class="w"> </span>NODES<span class="w"> </span><span class="kr">cross</span><span class="w"> </span>NODES<span class="p">;</span>

<span class="kd">param</span><span class="w"> </span><span class="nv">R</span><span class="p">{</span>RESISTORS<span class="p">}</span><span class="w"> </span><span class="kr">default</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="kd">param</span><span class="w"> </span><span class="nv">V</span><span class="p">{</span>GENERATORS<span class="p">}</span><span class="w"> </span><span class="kr">default</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="kd">param</span><span class="w"> </span><span class="nv">Ground</span><span class="w"> </span><span class="kt">symbolic</span><span class="w"> </span><span class="kr">within</span><span class="w"> </span>NODES<span class="p">;</span>

<span class="kd">set</span><span class="w"> </span><span class="nv">ARCS</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span>RESISTORS<span class="w"> </span><span class="kr">union</span><span class="w"> </span>GENERATORS<span class="p">;</span>

<span class="kd">var</span><span class="w"> </span><span class="nv">v</span><span class="p">{</span>ARCS<span class="p">};</span>
<span class="kd">var</span><span class="w"> </span><span class="nv">u</span><span class="p">{</span>NODES<span class="p">};</span>

<span class="kd">minimize</span><span class="w"> </span><span class="nv">Energy</span><span class="p">:</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">sum</span><span class="p">{(</span>i<span class="p">,</span>j<span class="p">)</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span>RESISTORS<span class="p">}</span><span class="w"> </span><span class="p">(</span>v<span class="p">[</span>i<span class="p">,</span>j<span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>v<span class="p">[</span>i<span class="p">,</span>j<span class="p">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span>R<span class="p">[</span>i<span class="p">,</span>j<span class="p">])</span><span class="w"> </span><span class="p">;</span>

<span class="kd">s.t.</span><span class="w"> </span><span class="nv">BalanceR</span><span class="p">{(</span>i<span class="p">,</span>j<span class="p">)</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span>RESISTORS<span class="p">}:</span>
<span class="w">	</span>u<span class="p">[</span>j<span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span>u<span class="p">[</span>i<span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>v<span class="p">[</span>i<span class="p">,</span>j<span class="p">];</span>

<span class="kd">s.t.</span><span class="w"> </span><span class="nv">BalanceG</span><span class="p">{(</span>i<span class="p">,</span>j<span class="p">)</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span>GENERATORS<span class="p">}:</span>
<span class="w">	</span>u<span class="p">[</span>j<span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span>u<span class="p">[</span>i<span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>V<span class="p">[</span>i<span class="p">,</span>j<span class="p">];</span>

<span class="kd">s.t.</span><span class="w"> </span><span class="nv">FixGround</span><span class="p">:</span>
<span class="w">	</span>u<span class="p">[</span>Ground<span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</pre></div>
</div>
</div>
<p>This problem can be solved through those solvers which accept
quadratic (convex) optimization problems.</p>
<p>We do not wish to go into further details, but it can be seen that
this problem has a Lagrange dual whose main variables are current
intensities. The optimal value of dual variables can be displayed, in
AMPL, as the language automatically associates to each constraint a
dual variable with the same name. So we can find voltages and currents
in the optimal solutions to the above model:</p>
<p>For the simple circuit used here as an example, we
obtain the solution:</p>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">circuit.out</span><a class="headerlink" href="#id9" title="Link to this code">¶</a></div>
<div class="highlight-ampl notranslate"><div class="highlight"><pre><span></span>u<span class="w"> </span><span class="p">[</span><span class="o">*</span><span class="p">]</span><span class="w"> </span><span class="p">:</span><span class="o">=</span>
A<span class="w">  </span><span class="mi">12</span>
B<span class="w">  </span><span class="mi">10</span>
C<span class="w">  </span><span class="mi">19</span>
D<span class="w">  </span><span class="o">-</span><span class="mi">3</span>
E<span class="w">   </span><span class="mi">0</span>
F<span class="w">  </span><span class="o">-</span><span class="mi">6</span>
<span class="p">;</span>

v<span class="w"> </span><span class="p">:</span><span class="o">=</span>
A<span class="w"> </span>B<span class="w">    </span><span class="o">-</span><span class="mi">2</span>
B<span class="w"> </span>E<span class="w">   </span><span class="o">-</span><span class="mi">10</span>
C<span class="w"> </span>B<span class="w">    </span><span class="o">-</span><span class="mi">9</span>
D<span class="w"> </span>E<span class="w">     </span><span class="mi">0</span>
D<span class="w"> </span>F<span class="w">    </span><span class="o">-</span><span class="mi">3</span>
E<span class="w"> </span>C<span class="w">     </span><span class="mi">0</span>
F<span class="w"> </span>A<span class="w">     </span><span class="mi">0</span>
<span class="p">;</span>

BalanceR<span class="w"> </span><span class="p">:</span><span class="o">=</span>
A<span class="w"> </span>B<span class="w">   </span><span class="mi">2</span>
B<span class="w"> </span>E<span class="w">   </span><span class="mi">5</span>
C<span class="w"> </span>B<span class="w">   </span><span class="mi">3</span>
D<span class="w"> </span>F<span class="w">   </span><span class="mi">2</span>
<span class="p">;</span>
</pre></div>
</div>
</div>
<p>which can be represented as</p>
<div class="figure" style="text-align: center"><p><img  src="_images/tikz-3d3105ad0926d36eedbc922c81c09ab797fe234b.png" alt="Figure made with TikZ" /></p>
</div></section>
<section id="elementary-portfolio-optimization">
<h2><span class="section-number">24.2. </span>Elementary portfolio optimization<a class="headerlink" href="#elementary-portfolio-optimization" title="Link to this heading">¶</a></h2>
<p>Another important set of convex quadratic   models is related to
financial optimization.  The model presented here is inspired by that
analyzed by Markowitz in 1952 and which eventually led him to win the
Nobel prize for Economics in 1990. The model is described in many papers
and books by Markowitz himself - see, e.g., an historical account in
<span id="id2">[<a class="reference internal" href="Bibliography.html#id13" title="Harry M. Markowitz. The early history of portfolio theory: 1600-1960. Financial Analysts Journal, 55(4):5–16, 1999. Publisher: CFA Institute.">Markowitz, 1999</a>]</span>. Only in 1999, however, Markowitz realized that the
same model had indeed been already discovered by the Italian
probabilist Bruno De Finetti. Markowitz admitted in 2006 that  the
origin of the model were to be traced back to De Finetti, see
<span id="id3">[<a class="reference internal" href="Bibliography.html#id12" title="Harry M. Markowitz. De Finetti scoops Markowitz. Journal of Investment Management, 4(3):5–18, 2006.">Markowitz, 2006</a>]</span>,
although he had re-discovered it independently.</p>
<p>Assume
a  set of <span class="math notranslate nohighlight">\(n\)</span>  <span class="target" id="index-7"></span>risky assets <span class="math notranslate nohighlight">\(\{S_1, S_2,
\ldots, S_n\}\)</span> is available. Each asset has an associated <span class="target" id="index-8"></span>return
<span class="math notranslate nohighlight">\(R_i\)</span>, which is, in general, random; it is also assumed that
different assets have returns which cannot be modeled as independent
random variables; on the contrary, they are typically correlated one to the other,
either positively or negatively. It is assumed that, for each asset,
the <span class="target" id="index-9"></span>expected return <span class="math notranslate nohighlight">\(\mathpar{\mu}_i = E(R)_i\)</span> is either
known or can be reliably estimated. It is also assumed that, for each pair
of assets, the covariance  of their returns is available or can be
estimated:</p>
<div class="math notranslate nohighlight">
\begin{align*}
\param{Q}_{ij}&amp; =\textrm{Cov}(S_i,S_j) \\
&amp; = E((S_i-\mathpar{\mu}_i)(S_j-\mathpar{\mu}_j))
\end{align*}</div><p>Often, in
order to obtain an estimate of these parameters, an historical set of
observations of actual returns is used. Assume that for a time
period <span class="math notranslate nohighlight">\(t=1,2,\ldots,T\)</span>
the actual return of an asset has been observed: <span class="math notranslate nohighlight">\(r_{it}\)</span>. Then
we can use the estimates:</p>
<div class="math notranslate nohighlight">
\begin{align*}
   \hat{\mu}_i &amp; = \frac{1}{T} \sum_{t=1}^T r_{it} \\
   \hat{\textrm{Cov}}_{ij} &amp; = \frac{1}{T} \sum_{t=1}^T
   (r_{it} - \hat{\mu}_i)(r_{jt} - \hat{\mu}_j)
\end{align*}</div><p>Whichever the method used to estimate averages and covariances,
assume that a fixed amount of money, conventionally assumed to be one
unit, needs to be invested. We denote by <span class="math notranslate nohighlight">\(\var{x}_i\)</span> the
fraction of the total investment devoted to asset <span class="math notranslate nohighlight">\(i\)</span>. The
constraint of optimal portfolio models include the following ones:</p>
<div class="math notranslate nohighlight">
\begin{align*}
\sum_{i=1}^n \var{x}_i &amp; = 1 \\
\var{x}_i &amp; \geq 0
\end{align*}</div><p>where the sign constraints means that no “short selling” is
allowed. Given these variables, the expected return of the portfolio,
thanks to the linearity of the expectation operator, is
easily computed as</p>
<div class="math notranslate nohighlight">
\begin{align*}
\sum_{i=1}^n \mathpar{\mu}_i \var{x}_i
\end{align*}</div><p>A frequently used measure of the <em>risk</em> of an investment is the
standard deviation of the return, although several alternative risk
measures are now in current use.  It can be proven that the <em>variance</em>
of a portfolio, given the covariance matrix <span class="math notranslate nohighlight">\(\param{Q}\)</span> is given by</p>
<div class="math notranslate nohighlight">
\begin{align*}
\sum_i \sum_j \var{x}_i \var{x}_j \param{Q}_{ij} &amp; = \var{x}^T
\param{Q} \var{x}
\end{align*}</div><p>From the above formulae, three main models can be derived in the
context of mean-variance portfolio theory:</p>
<div class="math notranslate nohighlight">
\begin{align*}
   f_1(\mathpar{\sigma}^2) &amp; = \max \mathpar{\mu}^T \var{x}  \\
    \var{x}^T \mathpar{Q} \var{x} &amp; \leq \mathpar{\sigma}^2 \\
    \mathbf{1}^T \var{x} &amp; = 1 \\
    \var{x} &amp; \geq 0
\end{align*}</div><div class="math notranslate nohighlight">
\begin{align*}
   f_2(\param{r}) &amp; = \min \var{x}^T \param{Q} \var{x} \\
   \mathpar{\mu}^T \var{x} &amp; \geq \param{r} \\
    \mathbf{1}^T \var{x} &amp; = 1 \\
    \var{x} &amp; \geq 0
\end{align*}</div><div class="math notranslate nohighlight">
\begin{align*}
   f_3(\mathpar{\lambda}) &amp; = \max \mathpar{\mu}^T \var{x} -
   \mathpar{\lambda} \var{x}^T \param{Q} \var{x} \\
    \mathbf{1}^T \var{x} &amp; = 1 \\
    \var{x} &amp; \geq 0
\end{align*}</div><p>Each of the three models above require some parameter to be specified
or, better, to be varied in order to generate a set of
<span class="target" id="index-10"></span>efficient portfolios. In the first model, the maximum expected
return is sought among all portfolios whose risk, measured in terms of
the variance, is below a threshold <span class="math notranslate nohighlight">\(\mathpar{\sigma}^2\)</span>; in the
second model a minimum risk portfolio is required, so that the
expected return of the investment is bounded below by a threshold
<span class="math notranslate nohighlight">\(r\)</span>. In the third model a compromise is sought between risk and
return, through the multiplier <span class="math notranslate nohighlight">\(\mathpar{\lambda}\)</span>. In the
author’s modest opinion, the third model is weaker, as
it is less interpretable by a user and mixes quantities which
are not comparable one to the other. In fact, a more correct version of the model would
require to use the standard deviation of the portfolio return, in place
of the variance, thus summing two quantities (return and standard
deviation) which have the same unit of measurement. However, the
square root operator needed to obtain the standard deviation would
cause the model to become numerically much more complex. In fact all
of the three models above are <em>convex</em> quadratic optimization  or
quadratically constrained convex problems, very easily
solvable with modern convex optimization algorithms.</p>
<p>In order to present an example of implementation of the model, we used
a set of  returns from  52 financial assets
observed over a period of more than 2500 days. The raw data used is contained in a
file whose first rows are displayed here:</p>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text">returns.dat (partial listing)</span><a class="headerlink" href="#id10" title="Link to this code">¶</a></div>
<div class="highlight-ampl notranslate"><div class="highlight"><pre><span></span><span class="kd">param</span><span class="w"> </span><span class="nv">T</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">2519</span><span class="p">;</span>
<span class="kd">set</span><span class="w"> </span><span class="nv">ASSETS</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span>AGG<span class="w">   </span>DBC<span class="w"> </span>DFE<span class="w"> </span>DIA<span class="w"> </span>DXJ<span class="w"> </span>EEM<span class="w"> </span>EFA<span class="w"> </span>EWG<span class="w"> </span>EWH<span class="w"> </span>EWI<span class="w"> </span>EWT<span class="w"> </span>EWU<span class="w"> </span>EWW<span class="w"> </span>EWY<span class="w"> </span>EWZ
EZU<span class="w"> </span>FEZ<span class="w"> </span>FXI<span class="w"> </span>GDX<span class="w"> </span>GLD<span class="w"> </span>IAU<span class="w"> </span>IBB<span class="w"> </span>ITB<span class="w"> </span>IVV<span class="w"> </span>IWD<span class="w"> </span>IWM<span class="w"> </span>IYR<span class="w"> </span>KBE<span class="w"> </span>KRE<span class="w"> </span>LQD<span class="w"> </span>OIL<span class="w"> </span>SDS<span class="w"> </span>SH<span class="w">  </span>SLV
SPY<span class="w"> </span>USO<span class="w"> </span>VGK<span class="w"> </span>VNQ<span class="w"> </span>VTI<span class="w"> </span>VWO<span class="w"> </span>XHB<span class="w"> </span>XLB<span class="w"> </span>XLE<span class="w"> </span>XLF<span class="w"> </span>XLI<span class="w"> </span>XLK<span class="w"> </span>XLP<span class="w"> </span>XLU<span class="w"> </span>XLV<span class="w"> </span>XLY<span class="w"> </span>XME<span class="w"> </span>XOP<span class="p">;</span>

<span class="kd">param</span><span class="w"> </span><span class="nv">Ret</span><span class="p">:</span>
<span class="w">	</span>AGG<span class="w"> </span>DBC<span class="w"> </span>DFE<span class="w"> </span>DIA<span class="w"> </span>DXJ<span class="w"> </span>EEM<span class="w"> </span>EFA<span class="w"> </span>EWG<span class="w"> </span>EWH<span class="w"> </span>EWI<span class="w"> </span>EWT<span class="w"> </span>EWU<span class="w"> </span>EWW<span class="w"> </span>EWY<span class="w"> </span>EWZ
EZU<span class="w"> </span>FEZ<span class="w"> </span>FXI<span class="w"> </span>GDX<span class="w"> </span>GLD<span class="w"> </span>IAU<span class="w"> </span>IBB<span class="w"> </span>ITB<span class="w"> </span>IVV<span class="w"> </span>IWD<span class="w"> </span>IWM<span class="w"> </span>IYR<span class="w"> </span>KBE<span class="w"> </span>KRE<span class="w"> </span>LQD<span class="w"> </span>OIL<span class="w"> </span>SDS<span class="w"> </span>SH<span class="w">  </span>SLV
SPY<span class="w"> </span>USO<span class="w"> </span>VGK<span class="w"> </span>VNQ<span class="w"> </span>VTI<span class="w"> </span>VWO<span class="w"> </span>XHB<span class="w"> </span>XLB<span class="w"> </span>XLE<span class="w"> </span>XLF<span class="w"> </span>XLI<span class="w"> </span>XLK<span class="w"> </span>XLP<span class="w"> </span>XLU<span class="w"> </span>XLV<span class="w"> </span>XLY<span class="w"> </span>XME<span class="w"> </span>XOP<span class="p">:</span><span class="o">=</span>
<span class="mi">1</span><span class="w"> </span><span class="mf">0.002</span><span class="w"> </span><span class="o">-</span><span class="mf">0.026</span><span class="w"> </span><span class="o">-</span><span class="mf">0.001</span><span class="w"> </span><span class="mf">0.002</span><span class="w"> </span><span class="mf">0.012</span><span class="w"> </span><span class="o">-</span><span class="mf">0.014</span><span class="w"> </span><span class="o">-</span><span class="mf">0.003</span><span class="w"> </span><span class="o">-</span><span class="mf">0.003</span><span class="w"> </span><span class="o">-</span><span class="mf">0.011</span><span class="w"> </span><span class="o">-</span><span class="mf">0.002</span>
<span class="mf">0.003</span><span class="w"> </span><span class="o">-</span><span class="mf">0.002</span><span class="w"> </span><span class="o">-</span><span class="mf">0.009</span><span class="w"> </span><span class="o">-</span><span class="mf">0.011</span><span class="w"> </span><span class="o">-</span><span class="mf">0.013</span><span class="w"> </span><span class="o">-</span><span class="mf">0.004</span><span class="w"> </span><span class="o">-</span><span class="mf">0.001</span><span class="w"> </span><span class="o">-</span><span class="mf">0.035</span><span class="w"> </span><span class="o">-</span><span class="mf">0.018</span><span class="w"> </span><span class="o">-</span><span class="mf">0.010</span>
<span class="o">-</span><span class="mf">0.008</span><span class="w"> </span><span class="mf">0.015</span><span class="w"> </span><span class="o">-</span><span class="mf">0.009</span><span class="w"> </span><span class="mf">0.003</span><span class="w"> </span><span class="o">-</span><span class="mf">0.002</span><span class="w"> </span><span class="mf">0.003</span><span class="w"> </span><span class="mf">0.000</span><span class="w"> </span><span class="mf">0.000</span><span class="w"> </span><span class="mf">0.003</span><span class="w"> </span><span class="mf">0.008</span>
<span class="o">-</span><span class="mf">0.041</span><span class="w"> </span><span class="o">-</span><span class="mf">0.004</span><span class="w"> </span><span class="o">-</span><span class="mf">0.002</span><span class="w"> </span><span class="mf">0.002</span><span class="w"> </span><span class="mf">0.002</span><span class="w"> </span><span class="o">-</span><span class="mf">0.042</span><span class="w"> </span><span class="o">-</span><span class="mf">0.002</span><span class="w"> </span><span class="mf">0.001</span><span class="w"> </span><span class="mf">0.002</span><span class="w"> </span><span class="o">-</span><span class="mf">0.011</span>
<span class="o">-</span><span class="mf">0.005</span><span class="w"> </span><span class="o">-</span><span class="mf">0.005</span><span class="w"> </span><span class="o">-</span><span class="mf">0.018</span><span class="w"> </span><span class="o">-</span><span class="mf">0.003</span><span class="w"> </span><span class="o">-</span><span class="mf">0.004</span><span class="w"> </span><span class="mf">0.015</span><span class="w"> </span><span class="mf">0.002</span><span class="w"> </span><span class="o">-</span><span class="mf">0.001</span><span class="w"> </span><span class="mf">0.011</span><span class="w"> </span><span class="mf">0.000</span>
<span class="o">-</span><span class="mf">0.005</span><span class="w"> </span><span class="o">-</span><span class="mf">0.013</span>
<span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="mf">0.001</span><span class="w"> </span><span class="mf">0.001</span><span class="w"> </span><span class="o">-</span><span class="mf">0.009</span><span class="w"> </span><span class="o">-</span><span class="mf">0.008</span><span class="w"> </span><span class="o">-</span><span class="mf">0.021</span><span class="w"> </span><span class="o">-</span><span class="mf">0.029</span><span class="w"> </span><span class="o">-</span><span class="mf">0.015</span><span class="w"> </span><span class="o">-</span><span class="mf">0.017</span><span class="w"> </span><span class="o">-</span><span class="mf">0.008</span><span class="w"> </span><span class="o">-</span><span class="mf">0.013</span>
<span class="o">-</span><span class="mf">0.025</span><span class="w"> </span><span class="o">-</span><span class="mf">0.019</span><span class="w"> </span><span class="o">-</span><span class="mf">0.023</span><span class="w"> </span><span class="o">-</span><span class="mf">0.024</span><span class="w"> </span><span class="o">-</span><span class="mf">0.035</span><span class="w"> </span><span class="o">-</span><span class="mf">0.012</span><span class="w"> </span><span class="o">-</span><span class="mf">0.017</span><span class="w"> </span><span class="o">-</span><span class="mf">0.057</span><span class="w"> </span><span class="o">-</span><span class="mf">0.014</span><span class="w"> </span><span class="o">-</span><span class="mf">0.024</span>
<span class="o">-</span><span class="mf">0.026</span><span class="w"> </span><span class="mf">0.000</span><span class="w"> </span><span class="o">-</span><span class="mf">0.010</span><span class="w"> </span><span class="o">-</span><span class="mf">0.008</span><span class="w"> </span><span class="o">-</span><span class="mf">0.008</span><span class="w"> </span><span class="o">-</span><span class="mf">0.021</span><span class="w"> </span><span class="o">-</span><span class="mf">0.015</span><span class="w"> </span><span class="o">-</span><span class="mf">0.010</span><span class="w"> </span><span class="o">-</span><span class="mf">0.021</span><span class="w"> </span><span class="o">-</span><span class="mf">0.001</span>
<span class="mf">0.007</span><span class="w"> </span><span class="mf">0.015</span><span class="w"> </span><span class="mf">0.006</span><span class="w"> </span><span class="o">-</span><span class="mf">0.032</span><span class="w"> </span><span class="o">-</span><span class="mf">0.008</span><span class="w"> </span><span class="mf">0.010</span><span class="w"> </span><span class="o">-</span><span class="mf">0.013</span><span class="w"> </span><span class="o">-</span><span class="mf">0.019</span><span class="w"> </span><span class="o">-</span><span class="mf">0.008</span><span class="w"> </span><span class="o">-</span><span class="mf">0.028</span>
<span class="o">-</span><span class="mf">0.009</span><span class="w"> </span><span class="o">-</span><span class="mf">0.007</span><span class="w"> </span><span class="mf">0.007</span><span class="w"> </span><span class="o">-</span><span class="mf">0.008</span><span class="w"> </span><span class="o">-</span><span class="mf">0.003</span><span class="w"> </span><span class="o">-</span><span class="mf">0.008</span><span class="w"> </span><span class="o">-</span><span class="mf">0.007</span><span class="w"> </span><span class="o">-</span><span class="mf">0.018</span><span class="w"> </span><span class="o">-</span><span class="mf">0.006</span><span class="w"> </span><span class="o">-</span><span class="mf">0.007</span>
<span class="o">-</span><span class="mf">0.009</span><span class="w"> </span><span class="mf">0.009</span>
<span class="mi">3</span><span class="w"> </span><span class="mf">0.001</span><span class="w"> </span><span class="mf">0.001</span><span class="w"> </span><span class="mf">0.004</span><span class="w"> </span><span class="mf">0.003</span><span class="w"> </span><span class="mf">0.001</span><span class="w"> </span><span class="mf">0.007</span><span class="w"> </span><span class="mf">0.001</span><span class="w"> </span><span class="o">-</span><span class="mf">0.003</span><span class="w"> </span><span class="mf">0.025</span><span class="w"> </span><span class="mf">0.001</span>
<span class="o">-</span><span class="mf">0.003</span><span class="w"> </span><span class="mf">0.004</span><span class="w"> </span><span class="mf">0.007</span><span class="w"> </span><span class="mf">0.002</span><span class="w"> </span><span class="mf">0.014</span><span class="w"> </span><span class="mf">0.002</span><span class="w"> </span><span class="mf">0.001</span><span class="w"> </span><span class="mf">0.029</span><span class="w"> </span><span class="mf">0.002</span><span class="w"> </span><span class="mf">0.005</span><span class="w"> </span><span class="mf">0.005</span>
<span class="mf">0.001</span><span class="w"> </span><span class="o">-</span><span class="mf">0.021</span><span class="w"> </span><span class="mf">0.004</span><span class="w"> </span><span class="mf">0.003</span><span class="w"> </span><span class="o">-</span><span class="mf">0.004</span><span class="w"> </span><span class="mf">0.000</span><span class="w"> </span><span class="mf">0.003</span><span class="w"> </span><span class="mf">0.000</span><span class="w"> </span><span class="mf">0.000</span><span class="w"> </span><span class="o">-</span><span class="mf">0.001</span><span class="w"> </span><span class="o">-</span><span class="mf">0.005</span>
<span class="o">-</span><span class="mf">0.002</span><span class="w"> </span><span class="mf">0.003</span><span class="w"> </span><span class="mf">0.005</span><span class="w"> </span><span class="o">-</span><span class="mf">0.007</span><span class="w"> </span><span class="o">-</span><span class="mf">0.003</span><span class="w"> </span><span class="mf">0.001</span><span class="w"> </span><span class="mf">0.004</span><span class="w"> </span><span class="mf">0.011</span><span class="w"> </span><span class="o">-</span><span class="mf">0.014</span><span class="w"> </span><span class="mf">0.000</span><span class="w"> </span><span class="mf">0.000</span>
<span class="mf">0.005</span><span class="w"> </span><span class="mf">0.004</span><span class="w"> </span><span class="mf">0.003</span><span class="w"> </span><span class="mf">0.002</span><span class="w"> </span><span class="o">-</span><span class="mf">0.001</span><span class="w"> </span><span class="mf">0.001</span><span class="w"> </span><span class="mf">0.002</span><span class="w"> </span><span class="mf">0.010</span><span class="w"> </span><span class="mf">0.004</span>
<span class="mi">4</span><span class="w"> </span><span class="mf">0.000</span><span class="w"> </span><span class="o">-</span><span class="mf">0.009</span><span class="w"> </span><span class="mf">0.000</span><span class="w"> </span><span class="o">-</span><span class="mf">0.001</span><span class="w"> </span><span class="mf">0.007</span><span class="w"> </span><span class="o">-</span><span class="mf">0.022</span><span class="w"> </span><span class="mf">0.001</span><span class="w"> </span><span class="mf">0.005</span><span class="w"> </span><span class="o">-</span><span class="mf">0.002</span><span class="w"> </span><span class="o">-</span><span class="mf">0.001</span>
<span class="o">-</span><span class="mf">0.010</span><span class="w"> </span><span class="o">-</span><span class="mf">0.006</span><span class="w"> </span><span class="o">-</span><span class="mf">0.027</span><span class="w"> </span><span class="o">-</span><span class="mf">0.011</span><span class="w"> </span><span class="o">-</span><span class="mf">0.025</span><span class="w"> </span><span class="o">-</span><span class="mf">0.002</span><span class="w"> </span><span class="o">-</span><span class="mf">0.002</span><span class="w"> </span><span class="o">-</span><span class="mf">0.044</span><span class="w"> </span><span class="o">-</span><span class="mf">0.007</span><span class="w"> </span><span class="mf">0.006</span><span class="w"> </span><span class="mf">0.007</span>
<span class="o">-</span><span class="mf">0.001</span><span class="w"> </span><span class="mf">0.002</span><span class="w"> </span><span class="o">-</span><span class="mf">0.001</span><span class="w"> </span><span class="o">-</span><span class="mf">0.003</span><span class="w"> </span><span class="mf">0.009</span><span class="w"> </span><span class="mf">0.012</span><span class="w"> </span><span class="o">-</span><span class="mf">0.002</span><span class="w"> </span><span class="o">-</span><span class="mf">0.004</span><span class="w"> </span><span class="mf">0.000</span><span class="w"> </span><span class="o">-</span><span class="mf">0.006</span><span class="w"> </span><span class="mf">0.001</span>
<span class="mf">0.000</span><span class="w"> </span><span class="mf">0.016</span><span class="w"> </span><span class="o">-</span><span class="mf">0.001</span><span class="w"> </span><span class="o">-</span><span class="mf">0.004</span><span class="w"> </span><span class="o">-</span><span class="mf">0.004</span><span class="w"> </span><span class="mf">0.013</span><span class="w"> </span><span class="mf">0.000</span><span class="w"> </span><span class="o">-</span><span class="mf">0.024</span><span class="w"> </span><span class="mf">0.006</span><span class="w"> </span><span class="mf">0.000</span><span class="w"> </span><span class="o">-</span><span class="mf">0.009</span>
<span class="o">-</span><span class="mf">0.002</span><span class="w"> </span><span class="o">-</span><span class="mf">0.001</span><span class="w"> </span><span class="mf">0.001</span><span class="w"> </span><span class="mf">0.002</span><span class="w"> </span><span class="mf">0.001</span><span class="w"> </span><span class="o">-</span><span class="mf">0.001</span><span class="w"> </span><span class="mf">0.005</span><span class="w"> </span><span class="o">-</span><span class="mf">0.011</span><span class="w"> </span><span class="o">-</span><span class="mf">0.010</span>
</pre></div>
</div>
</div>
<p>From these data we generated estimates for the expected return and
variance/covariance matrix:</p>
<div class="literal-block-wrapper docutils container" id="id11">
<div class="code-block-caption"><span class="caption-text">portfolio.dat (partial listing)</span><a class="headerlink" href="#id11" title="Link to this code">¶</a></div>
<div class="highlight-ampl notranslate"><div class="highlight"><pre><span></span><span class="kd">set</span><span class="w"> </span><span class="nv">ASSETS</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span>AGG<span class="w">   </span>DBC<span class="w"> </span>DFE<span class="w"> </span>DIA<span class="w"> </span>DXJ<span class="w"> </span>EEM<span class="w"> </span>EFA<span class="w"> </span>EWG<span class="w"> </span>EWH<span class="w"> </span>EWI<span class="w"> </span>EWT<span class="w"> </span>EWU<span class="w"> </span>EWW<span class="w"> </span>EWY<span class="w"> </span>EWZ
EZU<span class="w"> </span>FEZ<span class="w"> </span>FXI<span class="w"> </span>GDX<span class="w"> </span>GLD<span class="w"> </span>IAU<span class="w"> </span>IBB<span class="w"> </span>ITB<span class="w"> </span>IVV<span class="w"> </span>IWD<span class="w"> </span>IWM<span class="w"> </span>IYR<span class="w"> </span>KBE<span class="w"> </span>KRE<span class="w"> </span>LQD<span class="w"> </span>OIL<span class="w"> </span>SDS<span class="w"> </span>SH<span class="w">  </span>SLV
SPY<span class="w"> </span>USO<span class="w"> </span>VGK<span class="w"> </span>VNQ<span class="w"> </span>VTI<span class="w"> </span>VWO<span class="w"> </span>XHB<span class="w"> </span>XLB<span class="w"> </span>XLE<span class="w"> </span>XLF<span class="w"> </span>XLI<span class="w"> </span>XLK<span class="w"> </span>XLP<span class="w"> </span>XLU<span class="w"> </span>XLV<span class="w"> </span>XLY<span class="w"> </span>XME<span class="w"> </span>XOP<span class="p">;</span>

<span class="c1">#data generated by ampl returns.run on file returns.dat</span>

<span class="kd">param</span><span class="w"> </span><span class="nv">r</span><span class="w">  </span><span class="p">:</span><span class="o">=</span>
AGG<span class="w">  </span><span class="mf">2.3422e-05</span><span class="w">    </span>EWY<span class="w">  </span><span class="mf">0.000278682</span><span class="w">   </span>IYR<span class="w">  </span><span class="mf">0.000203652</span><span class="w">   </span>VWO<span class="w">  </span><span class="mf">0.000138547</span>
DBC<span class="w"> </span><span class="o">-</span><span class="mf">8.29694e-05</span><span class="w">   </span>EWZ<span class="w">  </span><span class="mf">0.000190552</span><span class="w">   </span>KBE<span class="w">  </span><span class="mf">0.000194125</span><span class="w">   </span>XHB<span class="w">  </span><span class="mf">0.000219532</span>
DFE<span class="w">  </span><span class="mf">3.93013e-05</span><span class="w">   </span>EZU<span class="w">  </span><span class="mf">1.58793e-06</span><span class="w">   </span>KRE<span class="w">  </span><span class="mf">0.00026836</span><span class="w">    </span>XLB<span class="w">  </span><span class="mf">0.000290195</span>
DIA<span class="w">  </span><span class="mf">0.000233426</span><span class="w">   </span>FEZ<span class="w"> </span><span class="o">-</span><span class="mf">2.50099e-05</span><span class="w">   </span>LQD<span class="w">  </span><span class="mf">5.31957e-05</span><span class="w">   </span>XLE<span class="w">  </span><span class="mf">0.000295355</span>
DXJ<span class="w">  </span><span class="mf">6.9869e-05</span><span class="w">    </span>FXI<span class="w">  </span><span class="mf">0.000272727</span><span class="w">   </span>OIL<span class="w"> </span><span class="o">-</span><span class="mf">0.000439857</span><span class="w">   </span>XLF<span class="w">  </span><span class="mf">7.82056e-05</span>
EEM<span class="w">  </span><span class="mf">0.000182612</span><span class="w">   </span>GDX<span class="w">  </span><span class="mf">0.00016316</span><span class="w">    </span>SDS<span class="w"> </span><span class="o">-</span><span class="mf">0.000736403</span><span class="w">   </span>XLI<span class="w">  </span><span class="mf">0.000341802</span>
EFA<span class="w">  </span><span class="mf">2.97737e-05</span><span class="w">   </span>GLD<span class="w">  </span><span class="mf">0.000307265</span><span class="w">    </span>SH<span class="w">  </span><span class="mf">2.77888e-06</span><span class="w">   </span>XLK<span class="w">  </span><span class="mf">0.000369591</span>
EWG<span class="w">  </span><span class="mf">0.000152044</span><span class="w">   </span>IAU<span class="w">  </span><span class="mf">0.000309647</span><span class="w">   </span>SLV<span class="w">  </span><span class="mf">0.000315204</span><span class="w">   </span>XLP<span class="w">  </span><span class="mf">0.000296943</span>
EWH<span class="w">  </span><span class="mf">0.000259627</span><span class="w">   </span>IBB<span class="w">  </span><span class="mf">0.000622072</span><span class="w">   </span>SPY<span class="w">  </span><span class="mf">0.000274712</span><span class="w">   </span>XLU<span class="w">  </span><span class="mf">0.000160778</span>
EWI<span class="w">  </span><span class="mf">0.000188567</span><span class="w">   </span>ITB<span class="w">  </span><span class="mf">0.000144105</span><span class="w">   </span>USO<span class="w"> </span><span class="o">-</span><span class="mf">0.000342596</span><span class="w">   </span>XLV<span class="w">  </span><span class="mf">0.000350536</span>
EWT<span class="w">  </span><span class="mf">0.000583168</span><span class="w">   </span>IVV<span class="w">  </span><span class="mf">0.000256451</span><span class="w">   </span>VGK<span class="w">  </span><span class="mf">5.95474e-06</span><span class="w">   </span>XLY<span class="w">  </span><span class="mf">0.000412068</span>
EWU<span class="w"> </span><span class="o">-</span><span class="mf">2.54069e-05</span><span class="w">   </span>IWD<span class="w">  </span><span class="mf">0.000213974</span><span class="w">   </span>VNQ<span class="w">  </span><span class="mf">0.000278682</span><span class="w">   </span>XME<span class="w">  </span><span class="mf">0.000234617</span>
EWW<span class="w">  </span><span class="mf">0.00011314</span><span class="w">    </span>IWM<span class="w">  </span><span class="mf">0.000361254</span><span class="w">   </span>VTI<span class="w">  </span><span class="mf">0.000290592</span><span class="w">   </span>XOP<span class="w">  </span><span class="mf">0.000377134</span>
<span class="p">;</span>

<span class="kd">param</span><span class="w"> </span><span class="nv">Q</span><span class="w"> </span><span class="p">[</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">]</span>
<span class="p">:</span><span class="w">         </span>AGG<span class="w">            </span>DBC<span class="w">            </span>DFE<span class="w">            </span>DIA<span class="w">            </span>DXJ<span class="w">    </span><span class="p">:</span><span class="o">=</span>
AGG<span class="w">    </span><span class="mf">1.14607e-05</span><span class="w">   </span><span class="o">-</span><span class="mf">1.99647e-06</span><span class="w">   </span><span class="o">-</span><span class="mf">3.58687e-06</span><span class="w">   </span><span class="o">-</span><span class="mf">5.04914e-06</span><span class="w">   </span><span class="o">-</span><span class="mf">3.56813e-06</span>
DBC<span class="w">   </span><span class="o">-</span><span class="mf">1.99647e-06</span><span class="w">    </span><span class="mf">0.000167994</span><span class="w">    </span><span class="mf">9.52069e-05</span><span class="w">    </span><span class="mf">6.573e-05</span><span class="w">      </span><span class="mf">7.31499e-05</span>
DFE<span class="w">   </span><span class="o">-</span><span class="mf">3.58687e-06</span><span class="w">    </span><span class="mf">9.52069e-05</span><span class="w">    </span><span class="mf">0.000240979</span><span class="w">    </span><span class="mf">0.000136476</span><span class="w">    </span><span class="mf">0.000138092</span>
DIA<span class="w">   </span><span class="o">-</span><span class="mf">5.04914e-06</span><span class="w">    </span><span class="mf">6.573e-05</span><span class="w">      </span><span class="mf">0.000136476</span><span class="w">    </span><span class="mf">0.000150001</span><span class="w">    </span><span class="mf">0.000127291</span>
DXJ<span class="w">   </span><span class="o">-</span><span class="mf">3.56813e-06</span><span class="w">    </span><span class="mf">7.31499e-05</span><span class="w">    </span><span class="mf">0.000138092</span><span class="w">    </span><span class="mf">0.000127291</span><span class="w">    </span><span class="mf">0.000236857</span>
EEM<span class="w">   </span><span class="o">-</span><span class="mf">7.96895e-06</span><span class="w">    </span><span class="mf">0.000138258</span><span class="w">    </span><span class="mf">0.000240632</span><span class="w">    </span><span class="mf">0.000222521</span><span class="w">    </span><span class="mf">0.000205307</span>
EFA<span class="w">   </span><span class="o">-</span><span class="mf">4.06699e-06</span><span class="w">    </span><span class="mf">0.000105163</span><span class="w">    </span><span class="mf">0.000204987</span><span class="w">    </span><span class="mf">0.000175019</span><span class="w">    </span><span class="mf">0.000179657</span>
EWG<span class="w">   </span><span class="o">-</span><span class="mf">5.99602e-06</span><span class="w">    </span><span class="mf">0.000115348</span><span class="w">    </span><span class="mf">0.000231467</span><span class="w">    </span><span class="mf">0.000189938</span><span class="w">    </span><span class="mf">0.000182988</span>
EWH<span class="w">   </span><span class="o">-</span><span class="mf">7.8584e-06</span><span class="w">     </span><span class="mf">9.1299e-05</span><span class="w">     </span><span class="mf">0.00017723</span><span class="w">     </span><span class="mf">0.000170088</span><span class="w">    </span><span class="mf">0.000163931</span>
EWI<span class="w">   </span><span class="o">-</span><span class="mf">6.77337e-06</span><span class="w">    </span><span class="mf">0.000126869</span><span class="w">    </span><span class="mf">0.000261691</span><span class="w">    </span><span class="mf">0.000199166</span><span class="w">    </span><span class="mf">0.000201912</span>
EWT<span class="w">   </span><span class="o">-</span><span class="mf">6.84256e-06</span><span class="w">    </span><span class="mf">8.85502e-05</span><span class="w">    </span><span class="mf">0.000185841</span><span class="w">    </span><span class="mf">0.000163249</span><span class="w">    </span><span class="mf">0.000158459</span>
</pre></div>
</div>
</div>
<p>and then we could run the optimization model:</p>
<div class="literal-block-wrapper docutils container" id="id12">
<div class="code-block-caption"><span class="caption-text">portfolio.mod</span><a class="headerlink" href="#id12" title="Link to this code">¶</a></div>
<div class="highlight-ampl notranslate"><div class="highlight"><pre><span></span><span class="kd">set</span><span class="w"> </span><span class="nv">ASSETS</span><span class="p">;</span>

<span class="kd">param</span><span class="w"> </span><span class="nv">r</span><span class="p">{</span>ASSETS<span class="p">};</span>
<span class="kd">param</span><span class="w"> </span><span class="nv">Q</span><span class="p">{</span>ASSETS<span class="p">,</span>ASSETS<span class="p">};</span>

<span class="kd">param</span><span class="w"> </span><span class="nv">rmin</span><span class="p">;</span>

<span class="kd">var</span><span class="w"> </span><span class="nv">x</span><span class="p">{</span>ASSETS<span class="p">}</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="kd">minimize</span><span class="w"> </span><span class="nv">risk</span><span class="p">:</span><span class="w"> </span><span class="kr">sum</span><span class="p">{</span>a1<span class="w"> </span><span class="kr">in</span><span class="w"> </span>ASSETS<span class="p">,</span><span class="w"> </span>a2<span class="w"> </span><span class="kr">in</span><span class="w"> </span>ASSETS<span class="p">}</span><span class="w"> </span>x<span class="p">[</span>a1<span class="p">]</span><span class="o">*</span>x<span class="p">[</span>a2<span class="p">]</span><span class="o">*</span>Q<span class="p">[</span>a1<span class="p">,</span>a2<span class="p">];</span>

<span class="kd">s.t.</span><span class="w"> </span><span class="nv">return</span><span class="p">:</span>
<span class="w">	</span><span class="kr">sum</span><span class="w"> </span><span class="p">{</span>a<span class="w"> </span><span class="kr">in</span><span class="w"> </span>ASSETS<span class="p">}</span><span class="w"> </span>r<span class="p">[</span>a<span class="p">]</span><span class="o">*</span>x<span class="p">[</span>a<span class="p">]</span><span class="w">  </span><span class="o">&gt;=</span><span class="w"> </span>rmin<span class="p">;</span>

<span class="kd">s.t.</span><span class="w"> </span><span class="nv">total</span><span class="p">:</span>
<span class="w">	</span><span class="kr">sum</span><span class="p">{</span>a<span class="w"> </span><span class="kr">in</span><span class="w"> </span>ASSETS<span class="p">}</span><span class="w"> </span>x<span class="p">[</span>a<span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</pre></div>
</div>
</div>
<p>This model requires a minimum expected return as a parameter. Instead
of choosing a fixed return, we solved the problem with a required
expected return between 0 and the maximum expected return of all
assets, in small steps. The results, generated with the following
command file:</p>
<div class="literal-block-wrapper docutils container" id="id13">
<div class="code-block-caption"><span class="caption-text">portfolioFrontier.run</span><a class="headerlink" href="#id13" title="Link to this code">¶</a></div>
<div class="highlight-ampl notranslate"><div class="highlight"><pre><span></span><span class="kr">model</span><span class="w"> </span>portfolio.<span class="kr">mod</span>
<span class="kr">data</span><span class="w"> </span>portfolio.dat
<span class="kr">option</span><span class="w"> </span>solver<span class="w"> </span>gurobi<span class="p">;</span>
<span class="kr">display</span><span class="w"> </span><span class="nb">min</span><span class="w"> </span><span class="p">{</span>a<span class="w"> </span><span class="kr">in</span><span class="w"> </span>ASSETS<span class="p">}</span><span class="w"> </span>r<span class="p">[</span>a<span class="p">];</span>

<span class="kr">display</span><span class="w"> </span><span class="nb">max</span><span class="w"> </span><span class="p">{</span>a<span class="w"> </span><span class="kr">in</span><span class="w"> </span>ASSETS<span class="p">}</span><span class="w"> </span>r<span class="p">[</span>a<span class="p">];</span>

<span class="kd">param</span><span class="w"> </span><span class="nv">maxR</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="w"> </span><span class="p">{</span>a<span class="w"> </span><span class="kr">in</span><span class="w"> </span>ASSETS<span class="p">}</span><span class="w"> </span>r<span class="p">[</span>a<span class="p">];</span>

<span class="kd">param</span><span class="w"> </span><span class="nv">Trials</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span>
<span class="kd">param</span><span class="w"> </span><span class="nv">SmallThreshold</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mf">0.001</span><span class="p">;</span>

<span class="kd">param</span><span class="w"> </span><span class="nv">OptRisk</span><span class="p">{</span><span class="mi">1</span><span class="o">..</span>Trials<span class="p">}</span><span class="w"> </span><span class="kr">default</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="kd">param</span><span class="w"> </span><span class="nv">OptRet</span><span class="p">{</span><span class="mi">1</span><span class="o">..</span>Trials<span class="p">}</span><span class="w"> </span><span class="kr">default</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="kd">param</span><span class="w"> </span><span class="nv">NotZero</span><span class="p">{</span><span class="mi">1</span><span class="o">..</span>Trials<span class="p">}</span><span class="w"> </span><span class="kr">default</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="kr">for</span><span class="w"> </span><span class="p">{</span>i<span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="mi">1</span><span class="o">..</span>Trials<span class="p">}</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="kd">let</span><span class="w"> </span><span class="nv">rmin</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span>i<span class="w"> </span><span class="o">*</span><span class="w"> </span>maxR<span class="o">/</span>Trials<span class="p">;</span>
<span class="w">   </span><span class="kr">solve</span><span class="p">;</span>
<span class="w">   </span><span class="kr">if</span><span class="w"> </span>solve_result<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;solved&quot;</span><span class="w"> </span><span class="kr">then</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">let</span><span class="w"> </span><span class="nv">OptRisk</span><span class="p">[</span>i<span class="p">]</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span>risk<span class="p">);</span>
<span class="w">      </span><span class="kd">let</span><span class="w"> </span><span class="nv">OptRet</span><span class="p">[</span>i<span class="p">]</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span>rmin<span class="p">;</span>
<span class="w">      </span><span class="kd">let</span><span class="w"> </span><span class="nv">NotZero</span><span class="p">[</span>i<span class="p">]</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="nb">card</span><span class="p">({</span>a<span class="w"> </span><span class="kr">in</span><span class="w"> </span>ASSETS<span class="p">:</span><span class="w"> </span>x<span class="p">[</span>a<span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span>SmallThreshold<span class="p">});</span>
<span class="w">   </span><span class="p">};</span>
<span class="p">};</span>

<span class="kr">display</span><span class="w"> </span>OptRisk<span class="p">,</span><span class="w"> </span>OptRet<span class="p">,</span><span class="w"> </span>NotZero<span class="p">;</span>
</pre></div>
</div>
</div>
<p>generated the following output:</p>
<div class="literal-block-wrapper docutils container" id="id14">
<div class="code-block-caption"><span class="caption-text">portfolioFrontier.out</span><a class="headerlink" href="#id14" title="Link to this code">¶</a></div>
<div class="highlight-ampl notranslate"><div class="highlight"><pre><span></span><span class="nb">min</span><span class="p">{</span>a<span class="w"> </span><span class="kr">in</span><span class="w"> </span>ASSETS<span class="p">}</span><span class="w"> </span>r<span class="p">[</span>a<span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mf">0.000736403</span>
<span class="nb">max</span><span class="p">{</span>a<span class="w"> </span><span class="kr">in</span><span class="w"> </span>ASSETS<span class="p">}</span><span class="w"> </span>r<span class="p">[</span>a<span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.000622072</span>

<span class="p">:</span><span class="w">      </span>OptRisk<span class="w">       </span>OptRet<span class="w">    </span>NotZero<span class="w">    </span><span class="p">:</span><span class="o">=</span>
<span class="mi">1</span><span class="w">     </span><span class="mf">0.00156315</span><span class="w">   </span><span class="mf">6.22072e-06</span><span class="w">     </span><span class="mi">17</span>
<span class="mi">2</span><span class="w">     </span><span class="mf">0.00158083</span><span class="w">   </span><span class="mf">1.24414e-05</span><span class="w">     </span><span class="mi">17</span>
<span class="mi">3</span><span class="w">     </span><span class="mf">0.00160206</span><span class="w">   </span><span class="mf">1.86622e-05</span><span class="w">     </span><span class="mi">19</span>
<span class="mi">4</span><span class="w">     </span><span class="mf">0.00162451</span><span class="w">   </span><span class="mf">2.48829e-05</span><span class="w">     </span><span class="mi">19</span>
<span class="mi">5</span><span class="w">     </span><span class="mf">0.00164919</span><span class="w">   </span><span class="mf">3.11036e-05</span><span class="w">     </span><span class="mi">17</span>
<span class="mi">6</span><span class="w">     </span><span class="mf">0.00167792</span><span class="w">   </span><span class="mf">3.73243e-05</span><span class="w">     </span><span class="mi">18</span>
<span class="mi">7</span><span class="w">     </span><span class="mf">0.00170841</span><span class="w">   </span><span class="mf">4.3545e-05</span><span class="w">      </span><span class="mi">16</span>
<span class="mi">8</span><span class="w">     </span><span class="mf">0.00174298</span><span class="w">   </span><span class="mf">4.97658e-05</span><span class="w">     </span><span class="mi">15</span>
<span class="mi">9</span><span class="w">     </span><span class="mf">0.00178248</span><span class="w">   </span><span class="mf">5.59865e-05</span><span class="w">     </span><span class="mi">15</span>
<span class="mi">10</span><span class="w">    </span><span class="mf">0.00182635</span><span class="w">   </span><span class="mf">6.22072e-05</span><span class="w">     </span><span class="mi">15</span>
<span class="mi">11</span><span class="w">    </span><span class="mf">0.00187457</span><span class="w">   </span><span class="mf">6.84279e-05</span><span class="w">     </span><span class="mi">15</span>
<span class="mi">12</span><span class="w">    </span><span class="mf">0.0019272</span><span class="w">    </span><span class="mf">7.46486e-05</span><span class="w">     </span><span class="mi">15</span>
<span class="mi">13</span><span class="w">    </span><span class="mf">0.00198372</span><span class="w">   </span><span class="mf">8.08694e-05</span><span class="w">     </span><span class="mi">15</span>
<span class="mi">14</span><span class="w">    </span><span class="mf">0.0020435</span><span class="w">    </span><span class="mf">8.70901e-05</span><span class="w">     </span><span class="mi">16</span>
<span class="mi">15</span><span class="w">    </span><span class="mf">0.00210609</span><span class="w">   </span><span class="mf">9.33108e-05</span><span class="w">     </span><span class="mi">16</span>
<span class="mi">16</span><span class="w">    </span><span class="mf">0.00217189</span><span class="w">   </span><span class="mf">9.95315e-05</span><span class="w">     </span><span class="mi">15</span>
<span class="mi">17</span><span class="w">    </span><span class="mf">0.0022405</span><span class="w">    </span><span class="mf">0.000105752</span><span class="w">     </span><span class="mi">14</span>
<span class="mi">18</span><span class="w">    </span><span class="mf">0.00231223</span><span class="w">   </span><span class="mf">0.000111973</span><span class="w">     </span><span class="mi">13</span>
<span class="mi">19</span><span class="w">    </span><span class="mf">0.0023869</span><span class="w">    </span><span class="mf">0.000118194</span><span class="w">     </span><span class="mi">12</span>
<span class="mi">20</span><span class="w">    </span><span class="mf">0.00246468</span><span class="w">   </span><span class="mf">0.000124414</span><span class="w">     </span><span class="mi">12</span>
<span class="mi">21</span><span class="w">    </span><span class="mf">0.00254733</span><span class="w">   </span><span class="mf">0.000130635</span><span class="w">     </span><span class="mi">12</span>
<span class="mi">22</span><span class="w">    </span><span class="mf">0.00263158</span><span class="w">   </span><span class="mf">0.000136856</span><span class="w">     </span><span class="mi">11</span>
<span class="mi">23</span><span class="w">    </span><span class="mf">0.00271818</span><span class="w">   </span><span class="mf">0.000143077</span><span class="w">     </span><span class="mi">11</span>
<span class="mi">24</span><span class="w">    </span><span class="mf">0.0028106</span><span class="w">    </span><span class="mf">0.000149297</span><span class="w">     </span><span class="mi">11</span>
<span class="mi">25</span><span class="w">    </span><span class="mf">0.00290396</span><span class="w">   </span><span class="mf">0.000155518</span><span class="w">     </span><span class="mi">11</span>
<span class="mi">26</span><span class="w">    </span><span class="mf">0.00299889</span><span class="w">   </span><span class="mf">0.000161739</span><span class="w">     </span><span class="mi">10</span>
</pre></div>
</div>
</div>
<p>In the output we can see the expected risk of the optimal portfolio
(standard deviation of the portfolio), the expected return as well as
the number of assets whose level, in the optimal solution, is
sufficiently far from 0. The following picture represents the obtained
results:</p>
<div class="figure" style="text-align: center"><p><img  src="_images/tikz-3957a8b7bdc5f8ff77e2e9b1d04d58c9b3abe935.png" alt="Figure made with TikZ" /></p>
</div><p>As it can be expected, higher expected return is always associated
with higher risk. In the picture we  also show the number of
assets in the optimal portfolios. It seems that higher return
portfolios have a lower number of assets: this fact is actually
related not to the return, but to the risk: the lower the number of
assets in the portfolio, the higher, in general, is the risk. So it is
reasonable to diversify. Diversification, as well as many other
variants like, e.g., the requirement that if an asset is chosen, then
its contribution to the total portfolio should be limited in a range
(e.g., at least 5%, at most 20%), can be easily modeled through the
introduction of binary variables and logical constraints:</p>
<div class="math notranslate nohighlight">
\begin{align*}
\param{LB}_i \mathvar{\delta}_i &amp; \leq  \var{x}_i \leq \param{UB}_i
\mathvar{\delta}_i \\
\sum_i \mathvar{\delta}_i &amp; \geq \param{K}
\end{align*}</div><p>It goes without saying that these additions make the model both non
linear and binary (for the sake of precision, being binary is already a non
linearity…). In general quadratic (even convex) optimization
problems with binary variables are hard to solve: to convince the
reader, take into account the fact that a linear function is a special
case of a convex quadratic one and, thus, quadratic integer
optimization is at least as difficult as linear integer
optimization.
Nonetheless, in many cases, optimal solution can be found through
advanced modern optimization solvers, if the structure of the problem
allows that and the size is not too large.
Modern, practical, portfolio optimization models differ, sometimes
substantially, from the Nobel-prize winning one described here. As a
minimum, they include transaction costs, a sort of fixed charge when
investing on an asset, and predetermined lot sizes, e.g., multiple of
1000 euros.  Moreover,  the variance of the investment
is no more considered as a practical and effective measure of the
risk. Other measures are used, one of which is the
<span class="target" id="index-11"></span>semi-variance or <span class="target" id="index-12"></span>downside risk defined as the
expected  value of the squared <em>negative</em> deviation from the expected
return. In other words, any deviation of the actual return which is
above the required expected one is considered as beneficial, while the
model penalizes any deviation which causes the actual return to be
below the threshold value. Other risk measures are the VaR, or
<span class="target" id="index-13"></span>Value at Risk and the CVaR, or <span class="target" id="index-14"></span>Conditional Value at
Risk. Their description is beyond the scope of this volume - there
are many publications on this important subject, among which we just
cite <span id="id4">[<a class="reference internal" href="Bibliography.html#id33" title="P. Artzner, Delbaen F., J.M. Eber, and D. Heath. Thinking coherently. Risk, 10:68–71, 1997.">Artzner <em>et al.</em>, 1997</a>]</span> and <span id="id5">[<a class="reference internal" href="Bibliography.html#id34" title="Stanislav Uryasev and R. Tyrrell Rockafellar. Conditional Value-at-Risk: Optimization Approach. In Stanislav Uryasev and Panos M. Pardalos, editors, Stochastic Optimization: Algorithms and Applications, pages 411–435. Springer US, Boston, MA, 2001.">Uryasev and Rockafellar, 2001</a>]</span>.</p>
</section>
<section id="support-vector-machines">
<h2><span class="section-number">24.3. </span>Support Vector Machines<a class="headerlink" href="#support-vector-machines" title="Link to this heading">¶</a></h2>
<p>There exists many methods for data analysis and prediction, most of
which are nowadays widely used for <span class="target" id="index-15"></span>classification  or for
<span class="target" id="index-16"></span>regression tasks. Assume we are given a set of observations
<span class="math notranslate nohighlight">\(X_1, X_2, \ldots, X_N\)</span>, each of which composed of <span class="math notranslate nohighlight">\(d\)</span>
<span class="target" id="index-17"></span>features, i.e., <span class="math notranslate nohighlight">\(X_i \in \R^d, \forall\,i\)</span>. Assume that
to
each of these observation a <span class="target" id="index-18"></span>label <span class="math notranslate nohighlight">\(Y_i\)</span> is
associated. This label might be <em>binary</em> (typically: <span class="math notranslate nohighlight">\(\pm 1\)</span>),
integer or generic real. We speak, respectively, of <span class="target" id="index-19"></span>binary
classification, <span class="target" id="index-20"></span>multi-class classification,
<span class="target" id="index-21"></span>regression. We would like to build a model, i.e., a function,
from the feature space to the label space which, in a sense to be made
precise, best approximates the available data.</p>
<p>Many approaches exist, depending on the task and the quantity and quality
of data. Among these, we recall decision trees, random forests,
artificial neural networks, support vector machines. All of these are
strictly related to optimization. In fact, choosing the “best”  model
for the available data is always an optimization problem whose aim is
to select the best parameters to characterize one out of a large
number of available  function, according to a quality criterion to be
optimized. We will briefly introduce here the concept of
<span class="target" id="index-22"></span>Support Vector Machines. Consider  a dataset, an example of
which is represented in the figure below:</p>
<div class="figure" style="text-align: center"><p><img  src="_images/tikz-e0ed830166f2f9ac1a42c536b423b6bc7ce235f8.png" alt="Figure made with TikZ" /></p>
</div><p>In the example above we plot a dataset of observations, each of which
consists of two features; the dataset is split into positive and
negative examples (two classes), represented here by two different
colors.
As it can be easily seen, this dataset is <span class="target" id="index-23"></span>linearly
separable. This means that there exists at least an (hyper)plane</p>
<div class="math notranslate nohighlight">
\begin{align*}
\var{w}^T x + \var{b} &amp; = 0
\end{align*}</div><p>such that</p>
<div class="math notranslate nohighlight">
\begin{align*}
\var{w}^T \param{X}_i + \var{b} &amp; \geq 1 &amp; \forall\, i: \param{Y}_i
= +1 \\
\var{w}^T \param{X}_i + \var{b} &amp; \leq -1 &amp; \forall\, i: \param{Y}_i
= -1 \\
\end{align*}</div><p>or, concisely,</p>
<div class="math notranslate nohighlight">
\begin{align*}
\param{Y}_i (\var{w}^T \param{X}_i + \var{b}) &amp; \geq 1 &amp; \forall\, i
\end{align*}</div><p>In cases like the one above, if there exists a separating hyperplane,
there usually exist an infinite number of them. The main idea of the Support
Vector Machine (SVM) approach is to chose the one which maximizes the
so-called
<span class="target" id="index-24"></span>margin. Consider any point in the dataset and denote by
<span class="math notranslate nohighlight">\(H(w,b)\)</span> the hyperplane <span class="math notranslate nohighlight">\(w^T x + b = 0\)</span>. The Euclidean distance of a
point from the hyperplane can be found to be equal to</p>
<div class="math notranslate nohighlight">
\begin{align*}
dist(\param{X}_i, H(w,b)) &amp; = \frac{|w^T \param{X}_i + b|}{\|w\|}
\end{align*}</div><p>The <em>margin</em> of an hyperplane is defined as the distance from the
hyperplane to the <em>closest</em>  point in the dataset:</p>
<div class="math notranslate nohighlight">
\begin{align*}
\min_{i=1,N} \frac{|w^T \param{X}_i + b|}{\|w\|}
\end{align*}</div><p>and the problem considered by the SVM approach is to find a separating hyperplane
with maximum margin:</p>
<div class="math notranslate nohighlight">
\begin{align*}
\max_{\var{w}, \var{b}} \min_{i=1,N} \frac{|\var{w}^T \param{X}_i +
\var{b}|}{\|\var{w}\|} &amp; \\
\param{Y}_i (\var{w}^T \param{X}_i + \var{b}) &amp; \geq 1 &amp; \forall\,i=1,N
\end{align*}</div><p>This apparently complex non linear problem can be proven to be
equivalent to the following quadratic one:</p>
<div class="math notranslate nohighlight">
\begin{align*}
\min_{\var{w}, \var{b}}  \var{w}^T\var{w} &amp; \\
\param{Y}_i (\var{w}^T \param{X}_i + \var{b}) &amp; \geq 1 &amp; \forall\,i=1,N
\end{align*}</div><p>and a geometrical representation of the maximum margin separating
hyperplane is given in the figure:</p>
<div class="figure" style="text-align: center"><p><img  src="_images/tikz-58833d87ea1253a2b0c41efc3038d81f1fe479dd.png" alt="Figure made with TikZ" /></p>
</div><p>There exists highly specialized software  for the solution of the
above problem, the most famous and widely used one is contained in the
LibSVM library by Chih-Jen Lin <span id="id6">[<a class="reference internal" href="Bibliography.html#id30" title="Chih-Chung Chang and Chih-Jen Lin. LIBSVM: a library for support vector machines. ACM Transactions on Intelligent Systems and Technology, 2:27:1–27:27, 2011. URL: http://www.csie.ntu.edu.tw/~cjlin/libsvm.">Chang and Lin, 2011</a>]</span>. We do not report here a
numerical example for this convex quadratic problem with linear
constraints, as the interest in problems like this one is mainly for
cases in which large datasets are available. And we just note in
passing that there are many important extensions to the basic model:
we can account for outliers, we can solve the dual problem instead of
the one reported here, we might extend the model to include so called
<span class="target" id="index-25"></span>kernels which allow us to generate highly non linear
separating hypersurfaces. We would like just to observe that all of
these extensions do not make the model deviate from a quadratic one
with linear constraints.</p>
</section>
<section id="quadratic-assignment">
<h2><span class="section-number">24.4. </span>Quadratic Assignment<a class="headerlink" href="#quadratic-assignment" title="Link to this heading">¶</a></h2>
<p>A very relevant, important and particularly hard to solve
combinatorial model goes under the name of <em>Quadratic Assignment</em> and
consists in an extension of the classical bi-partite assignment model
with a quadratic objective function.</p>
<p>A possible example of application of this model is related to facility
location. Assume, e.g. in planning the wards of a new hospital, that
<span class="math notranslate nohighlight">\(n\)</span> location have been chosen and that <span class="math notranslate nohighlight">\(n\)</span> facilities
(wards, in the example) need to be assigned, one to each
location. This is a classical setting for the bi-partite
assignment model: a binary variable <span class="math notranslate nohighlight">\(\mathvar{\delta}_{ij}\)</span> can
be used to decide whether facility <span class="math notranslate nohighlight">\(i\)</span> is assigned to location
<span class="math notranslate nohighlight">\(j\)</span> or not. In another application, locations might be places in
a circuit and facilities are electric or electronic equipment to be
placed in the available places. Once a decision has been taken, the
cost associated to the decision depends on two parameters, both of
which take into account the allocation of pairs of facilities: the
distance between two different facilities, and the (expected) patient
flow between the two facilities. In the circuit design example, these
two parameters might be, again, the distance and the number of wires
to be placed to connect the two components.  The overall cost of an
assignment is thus obtained as the sum of all costs associated to each
pair of locations chosen for each facility. The idea is that, in the
ward case, wards with a large flow of people should be placed as close
as possible, while pairs of wards with relative low traffic might be
located far from each other.
So, in the model, we should consider pairs of facilities and pairs of
possible location, and assign a cost which depends from one side on
the distance between the two chosen locations, while from the other
also on the flow between the two facilities. Let <span class="math notranslate nohighlight">\(\param{Dist}\)</span>
be  a matrix which represent the distance between two locations and
<span class="math notranslate nohighlight">\(\param{Flow}\)</span> be another matrix representing flows between pairs of
facilities, a quadratic model of this problem might be</p>
<div class="math notranslate nohighlight">
\begin{align*}
\min \sum_{i,j \in \set{Facilities}}
\sum_{h,k \in \set{Locations}}
\param{Dist}_{ij} \param{Flow}_{hk}\, \mathvar{\delta}_{ih}
\mathvar{\delta}_{jk} \\
\sum_{i} \mathvar{\delta}_{ih} &amp; = 1 &amp; \forall\, h \\
\sum_h \mathvar{\delta}_{ih} &amp; = 1 &amp; \forall\, i \\
\mathvar{\delta}_{ih} &amp; \in \{0,1\}
\end{align*}</div><p>A numerical example can be given for illustration, based on the
following graph:</p>
<div class="figure" style="text-align: center"><p><img  src="_images/tikz-a0288d48ede6c8e6d7b9b67ae7cce36c624188df.png" alt="Figure made with TikZ" /></p>
</div><p>In the figure it is assumed that all edges have length one. The
distance between any two locations in the graph is easily computed and
can be traced back to <span class="target" id="index-26"></span>Manhattan distance: nodes are
considered as blocks in a city with perpendicular roads. Given these
locations, and their pairwise distances, it is assumed that also the
expected flows between any two pairs of facilities is given. The
following datafile implements an example based on the above graph:</p>
<div class="literal-block-wrapper docutils container" id="id15">
<div class="code-block-caption"><span class="caption-text">qap.dat</span><a class="headerlink" href="#id15" title="Link to this code">¶</a></div>
<div class="highlight-ampl notranslate"><div class="highlight"><pre><span></span><span class="kd">set</span><span class="w"> </span><span class="nv">LOCATIONS</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span>A<span class="w"> </span>B<span class="w"> </span>C<span class="w"> </span>D<span class="w"> </span>E<span class="w"> </span>F<span class="w"> </span>G<span class="w"> </span>H<span class="w"> </span>I<span class="w"> </span>J<span class="w"> </span>K<span class="w"> </span>L<span class="p">;</span>
<span class="kd">set</span><span class="w"> </span><span class="nv">FACILITIES</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="mi">12</span><span class="p">;</span>

<span class="kd">param</span><span class="w"> </span><span class="nv">Dist</span>
<span class="p">:</span><span class="w">    </span>A<span class="w">   </span>B<span class="w">   </span>C<span class="w">   </span>D<span class="w">   </span>E<span class="w">   </span>F<span class="w">   </span>G<span class="w">   </span>H<span class="w">   </span>I<span class="w">   </span>J<span class="w">   </span>K<span class="w">   </span>L<span class="w">    </span><span class="p">:</span><span class="o">=</span>
A<span class="w">    </span><span class="mi">0</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">5</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">5</span><span class="w">   </span><span class="mi">6</span><span class="w">   </span><span class="mi">7</span>
B<span class="w">    </span><span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">5</span><span class="w">   </span><span class="mi">6</span>
C<span class="w">    </span><span class="mi">2</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">5</span>
D<span class="w">    </span><span class="mi">2</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">5</span>
E<span class="w">    </span><span class="mi">3</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">4</span>
F<span class="w">    </span><span class="mi">4</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">3</span>
G<span class="w">    </span><span class="mi">4</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">3</span>
H<span class="w">    </span><span class="mi">5</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">2</span>
I<span class="w">    </span><span class="mi">3</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">5</span><span class="w">   </span><span class="mi">6</span>
J<span class="w">    </span><span class="mi">5</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">2</span>
K<span class="w">    </span><span class="mi">6</span><span class="w">   </span><span class="mi">5</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">5</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">1</span>
L<span class="w">    </span><span class="mi">7</span><span class="w">   </span><span class="mi">6</span><span class="w">   </span><span class="mi">5</span><span class="w">   </span><span class="mi">5</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">6</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">0</span>
<span class="p">;</span>

<span class="kd">param</span><span class="w"> </span><span class="nv">Flow</span>
<span class="p">:</span><span class="w">  </span><span class="mi">1</span><span class="w">  </span><span class="mi">2</span><span class="w">  </span><span class="mi">3</span><span class="w">  </span><span class="mi">4</span><span class="w">  </span><span class="mi">5</span><span class="w">  </span><span class="mi">6</span><span class="w">  </span><span class="mi">7</span><span class="w">  </span><span class="mi">8</span><span class="w">  </span><span class="mi">9</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="mi">12</span><span class="w">    </span><span class="p">:</span><span class="o">=</span>
<span class="mi">1</span><span class="w">  </span><span class="mi">0</span><span class="w">  </span><span class="mi">3</span><span class="w">  </span><span class="mi">4</span><span class="w">  </span><span class="mi">6</span><span class="w">  </span><span class="mi">8</span><span class="w">  </span><span class="mi">5</span><span class="w">  </span><span class="mi">6</span><span class="w">  </span><span class="mi">6</span><span class="w">  </span><span class="mi">5</span><span class="w">  </span><span class="mi">1</span><span class="w">  </span><span class="mi">4</span><span class="w">  </span><span class="mi">6</span>
<span class="mi">2</span><span class="w">  </span><span class="mi">3</span><span class="w">  </span><span class="mi">0</span><span class="w">  </span><span class="mi">6</span><span class="w">  </span><span class="mi">3</span><span class="w">  </span><span class="mi">7</span><span class="w">  </span><span class="mi">9</span><span class="w">  </span><span class="mi">9</span><span class="w">  </span><span class="mi">2</span><span class="w">  </span><span class="mi">2</span><span class="w">  </span><span class="mi">7</span><span class="w">  </span><span class="mi">4</span><span class="w">  </span><span class="mi">7</span>
<span class="mi">3</span><span class="w">  </span><span class="mi">4</span><span class="w">  </span><span class="mi">6</span><span class="w">  </span><span class="mi">0</span><span class="w">  </span><span class="mi">2</span><span class="w">  </span><span class="mi">6</span><span class="w">  </span><span class="mi">4</span><span class="w">  </span><span class="mi">4</span><span class="w">  </span><span class="mi">4</span><span class="w">  </span><span class="mi">2</span><span class="w">  </span><span class="mi">6</span><span class="w">  </span><span class="mi">3</span><span class="w">  </span><span class="mi">6</span>
<span class="mi">4</span><span class="w">  </span><span class="mi">6</span><span class="w">  </span><span class="mi">3</span><span class="w">  </span><span class="mi">2</span><span class="w">  </span><span class="mi">0</span><span class="w">  </span><span class="mi">5</span><span class="w">  </span><span class="mi">5</span><span class="w">  </span><span class="mi">3</span><span class="w">  </span><span class="mi">3</span><span class="w">  </span><span class="mi">9</span><span class="w">  </span><span class="mi">4</span><span class="w">  </span><span class="mi">3</span><span class="w">  </span><span class="mi">6</span>
<span class="mi">5</span><span class="w">  </span><span class="mi">8</span><span class="w">  </span><span class="mi">7</span><span class="w">  </span><span class="mi">6</span><span class="w">  </span><span class="mi">5</span><span class="w">  </span><span class="mi">0</span><span class="w">  </span><span class="mi">4</span><span class="w">  </span><span class="mi">3</span><span class="w">  </span><span class="mi">4</span><span class="w">  </span><span class="mi">5</span><span class="w">  </span><span class="mi">7</span><span class="w">  </span><span class="mi">6</span><span class="w">  </span><span class="mi">7</span>
<span class="mi">6</span><span class="w">  </span><span class="mi">5</span><span class="w">  </span><span class="mi">9</span><span class="w">  </span><span class="mi">4</span><span class="w">  </span><span class="mi">5</span><span class="w">  </span><span class="mi">4</span><span class="w">  </span><span class="mi">0</span><span class="w">  </span><span class="mi">8</span><span class="w">  </span><span class="mi">5</span><span class="w">  </span><span class="mi">5</span><span class="w">  </span><span class="mi">5</span><span class="w">  </span><span class="mi">7</span><span class="w">  </span><span class="mi">5</span>
<span class="mi">7</span><span class="w">  </span><span class="mi">6</span><span class="w">  </span><span class="mi">9</span><span class="w">  </span><span class="mi">4</span><span class="w">  </span><span class="mi">3</span><span class="w">  </span><span class="mi">3</span><span class="w">  </span><span class="mi">8</span><span class="w">  </span><span class="mi">0</span><span class="w">  </span><span class="mi">6</span><span class="w">  </span><span class="mi">8</span><span class="w">  </span><span class="mi">4</span><span class="w">  </span><span class="mi">6</span><span class="w">  </span><span class="mi">7</span>
<span class="mi">8</span><span class="w">  </span><span class="mi">6</span><span class="w">  </span><span class="mi">2</span><span class="w">  </span><span class="mi">4</span><span class="w">  </span><span class="mi">3</span><span class="w">  </span><span class="mi">4</span><span class="w">  </span><span class="mi">5</span><span class="w">  </span><span class="mi">6</span><span class="w">  </span><span class="mi">0</span><span class="w">  </span><span class="mi">1</span><span class="w">  </span><span class="mi">5</span><span class="w">  </span><span class="mi">5</span><span class="w">  </span><span class="mi">3</span>
<span class="mi">9</span><span class="w">  </span><span class="mi">5</span><span class="w">  </span><span class="mi">2</span><span class="w">  </span><span class="mi">2</span><span class="w">  </span><span class="mi">9</span><span class="w">  </span><span class="mi">5</span><span class="w">  </span><span class="mi">5</span><span class="w">  </span><span class="mi">8</span><span class="w">  </span><span class="mi">1</span><span class="w">  </span><span class="mi">0</span><span class="w">  </span><span class="mi">4</span><span class="w">  </span><span class="mi">5</span><span class="w">  </span><span class="mi">2</span>
<span class="mi">10</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="mi">7</span><span class="w">  </span><span class="mi">6</span><span class="w">  </span><span class="mi">4</span><span class="w">  </span><span class="mi">7</span><span class="w">  </span><span class="mi">5</span><span class="w">  </span><span class="mi">4</span><span class="w">  </span><span class="mi">5</span><span class="w">  </span><span class="mi">4</span><span class="w">  </span><span class="mi">0</span><span class="w">  </span><span class="mi">7</span><span class="w">  </span><span class="mi">7</span>
<span class="mi">11</span><span class="w"> </span><span class="mi">4</span><span class="w">  </span><span class="mi">4</span><span class="w">  </span><span class="mi">3</span><span class="w">  </span><span class="mi">3</span><span class="w">  </span><span class="mi">6</span><span class="w">  </span><span class="mi">7</span><span class="w">  </span><span class="mi">6</span><span class="w">  </span><span class="mi">5</span><span class="w">  </span><span class="mi">5</span><span class="w">  </span><span class="mi">7</span><span class="w">  </span><span class="mi">0</span><span class="w">  </span><span class="mi">9</span>
<span class="mi">12</span><span class="w"> </span><span class="mi">6</span><span class="w">  </span><span class="mi">7</span><span class="w">  </span><span class="mi">6</span><span class="w">  </span><span class="mi">6</span><span class="w">  </span><span class="mi">7</span><span class="w">  </span><span class="mi">5</span><span class="w">  </span><span class="mi">7</span><span class="w">  </span><span class="mi">3</span><span class="w">  </span><span class="mi">2</span><span class="w">  </span><span class="mi">7</span><span class="w">  </span><span class="mi">9</span><span class="w">  </span><span class="mi">0</span>
<span class="p">;</span>
</pre></div>
</div>
</div>
<p>and a straightforward model of the problem is given in the following:</p>
<div class="literal-block-wrapper docutils container" id="id16">
<div class="code-block-caption"><span class="caption-text">qap.mod</span><a class="headerlink" href="#id16" title="Link to this code">¶</a></div>
<div class="highlight-ampl notranslate"><div class="highlight"><pre><span></span><span class="kd">set</span><span class="w"> </span><span class="nv">LOCATIONS</span><span class="p">;</span>
<span class="kd">set</span><span class="w"> </span><span class="nv">FACILITIES</span><span class="p">;</span>

<span class="kd">param</span><span class="w"> </span><span class="nv">Dist</span><span class="p">{</span>LOCATIONS<span class="p">,</span><span class="w"> </span>LOCATIONS<span class="p">};</span>
<span class="kd">param</span><span class="w"> </span><span class="nv">Flow</span><span class="p">{</span>FACILITIES<span class="p">,</span><span class="w"> </span>FACILITIES<span class="p">};</span>

<span class="kd">var</span><span class="w"> </span><span class="nv">delta</span><span class="p">{</span>FACILITIES<span class="p">,</span><span class="w"> </span>LOCATIONS<span class="p">}</span><span class="w"> </span><span class="kt">binary</span><span class="p">;</span><span class="w">  </span><span class="c1"># assign facility i to location j</span>


<span class="kd">minimize</span><span class="w"> </span><span class="nv">TotalCost</span><span class="w"> </span><span class="p">:</span>
<span class="w">     </span><span class="kr">sum</span><span class="p">{</span>i<span class="w"> </span><span class="kr">in</span><span class="w"> </span>FACILITIES<span class="p">,</span><span class="w"> </span>j<span class="w"> </span><span class="kr">in</span><span class="w"> </span>FACILITIES<span class="p">,</span><span class="w"> </span>k<span class="w"> </span><span class="kr">in</span><span class="w"> </span>LOCATIONS<span class="p">,</span><span class="w"> </span>h<span class="w"> </span><span class="kr">in</span><span class="w"> </span>LOCATIONS<span class="p">}</span>
<span class="w">     </span>delta<span class="p">[</span>i<span class="p">,</span>k<span class="p">]</span><span class="o">*</span>delta<span class="p">[</span>j<span class="p">,</span>h<span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>Dist<span class="p">[</span>h<span class="p">,</span>k<span class="p">]</span><span class="o">*</span>Flow<span class="p">[</span>i<span class="p">,</span>j<span class="p">];</span>

<span class="kd">s.t.</span><span class="w"> </span><span class="nv">OneLocation</span><span class="p">{</span>i<span class="w"> </span><span class="kr">in</span><span class="w"> </span>FACILITIES<span class="p">}:</span>
<span class="w">	</span><span class="kr">sum</span><span class="p">{</span>j<span class="w"> </span><span class="kr">in</span><span class="w"> </span>LOCATIONS<span class="p">}</span><span class="w"> </span>delta<span class="p">[</span>i<span class="p">,</span>j<span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>

<span class="kd">s.t.</span><span class="w"> </span><span class="nv">OneFacility</span><span class="p">{</span>j<span class="w"> </span><span class="kr">in</span><span class="w"> </span>LOCATIONS<span class="p">}:</span>
<span class="w">	</span><span class="kr">sum</span><span class="p">{</span>i<span class="w"> </span><span class="kr">in</span><span class="w"> </span>FACILITIES<span class="p">}</span><span class="w"> </span>delta<span class="p">[</span>i<span class="p">,</span>j<span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span>
</pre></div>
</div>
</div>
<p>Despite its apparent simplicity, solving this model is far
from being easy, even at this relatively small dimension. After
roughly one hour of computation, we stopped a top performing exact
solver and obtained the following solution which, by the way, is
indeed optimal. However, according to the output of the stopped
solver, a gap as large as 16.7% still existed between the best
feasible solution (of value 1652) and the current lower bound
(1375.9).</p>
<div class="figure" style="text-align: center"><p><img  src="_images/tikz-444de6ee6e5c387a52ac6377c6aa7e1d96790a7b.png" alt="Figure made with TikZ" /></p>
</div><p>The literature on the quadratic assignment problem is huge, both for
the many applications of the model, and for the extreme difficulty in
solving even small scale instances. It is evident that different
formulations are possible. As an example, it is possible to reduce the
problem to a purely linear binary one by introducing a large set of
binary variables to substitute the quadratic terms:</p>
<div class="math notranslate nohighlight">
\begin{align*}
\mathvar{\delta}_{ih}=\mathvar{\delta}_{jk} = 1 &amp; \iff
\var{y}_{ijhk}= 1
\end{align*}</div><p>which can be formulated as</p>
<div class="math notranslate nohighlight">
\begin{align*}
\mathvar{\delta}_{ih} &amp; \geq    \var{y}_{ijhk}\\
\mathvar{\delta}_{jk} &amp; \geq    \var{y}_{ijhk}\\
\mathvar{\delta}_{ih}+\mathvar{\delta}_{jk}  &amp; \leq
2 \var{y}_{ijhk}
\end{align*}</div><p>Although this way the problem  becomes a linear binary one, its
complexity is not diminished and the number of required variables is
in general very high. The problem remains one of the most difficult
“small” scale combinatorial optimization problems known.</p>
<p><a class="reference external" href="https://creativecommons.org/licenses/by-nc-nd/3.0/"><img alt="CreativeCommonsLicence" src="_images/Cc-by-nc-nd_icon.svg.png" /></a></p>
<p>© Fabio Schoen 2024</p>
</section>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="Arcrouting.html" title="Previous document"><span class="section-number">23. </span>Arc routing</a>
        </li>
        <li>
          <a href="Appendix.html" title="Next document"><span class="section-number">25. </span>Appendix</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="contents.html">
              <img class="logo" src="_static/OM.jpg" alt="Logo of OptimizationModels"/>
            </a></p>
  <div>
    <h3><a href="contents.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">24. Quadratic Optimization Models</a><ul>
<li><a class="reference internal" href="#solving-linear-electrical-networks">24.1. Solving linear electrical networks</a></li>
<li><a class="reference internal" href="#elementary-portfolio-optimization">24.2. Elementary portfolio optimization</a></li>
<li><a class="reference internal" href="#support-vector-machines">24.3. Support Vector Machines</a></li>
<li><a class="reference internal" href="#quadratic-assignment">24.4. Quadratic Assignment</a></li>
</ul>
</li>
</ul>

  </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="contents.html">Document start page</a><ul>
      <li>Previous: <a href="Arcrouting.html" title="previous chapter"><span class="section-number">23. </span>Arc routing</a></li>
      <li>Next: <a href="Appendix.html" title="next chapter"><span class="section-number">25. </span>Appendix</a></li>
  </ul></li>
</ul>
</div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;Fabio Schoen,  v 1.02 / April 4th, 2024, Creative Commons Cc-by-nc-nd.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 9.0.4</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/Quadratic.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>